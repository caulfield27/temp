const _0x3d8740 = _0x5f5a;
(function (_0x25338f, _0x55ae5f) {
  const _0x2bda00 = _0x5f5a,
    _0x4db8eb = _0x25338f();
  while (!![]) {
    try {
      const _0x3e005a =
        (-parseInt(_0x2bda00(0x167)) / 0x1) *
          (parseInt(_0x2bda00(0x190)) / 0x2) +
        -parseInt(_0x2bda00(0x171)) / 0x3 +
        (-parseInt(_0x2bda00(0x17e)) / 0x4) *
          (-parseInt(_0x2bda00(0x1ab)) / 0x5) +
        parseInt(_0x2bda00(0x161)) / 0x6 +
        -parseInt(_0x2bda00(0x1ad)) / 0x7 +
        -parseInt(_0x2bda00(0x172)) / 0x8 +
        (parseInt(_0x2bda00(0x18e)) / 0x9) * (parseInt(_0x2bda00(0x175)) / 0xa);
      if (_0x3e005a === _0x55ae5f) break;
      else _0x4db8eb['push'](_0x4db8eb['shift']());
    } catch (_0x358783) {
      _0x4db8eb['push'](_0x4db8eb['shift']());
    }
  }
})(_0x44bf, 0xe10c8);
function _0x44bf() {
  const _0x5a4bae = [
    'send',
    'deviceId',
    'scaleX(-1)',
    'attachCamera',
    'scale',
    'then',
    'height',
    '45vOOczy',
    'onerror',
    '182RPhqUv',
    'center',
    'mode',
    'успешно:\x20',
    'timeout',
    'log',
    'close',
    'interval',
    'onError',
    'isUnavailableCamera',
    'playsInline',
    'videoHeight',
    'muted',
    'overflow',
    'canvas',
    'src',
    'toDataURL',
    'onload',
    'width',
    '100%',
    'flex',
    'navigator',
    'getContext',
    'readyState',
    'drawImage',
    'display',
    'split',
    '1368920lXzgKV',
    'isSuccess',
    '3370507fgCQgu',
    'rootNode',
    'parse',
    'transform',
    'forEach',
    'getVideoTracks',
    'getSettings',
    'options',
    'none',
    'data',
    'innerWidth',
    'srcObject',
    'mediaDevices',
    '5189274aXGgOu',
    '1.0',
    'message',
    'stringify',
    'isCameraActive',
    'connectWS',
    '10251otAQCU',
    'style',
    'init',
    'addEventListener',
    'hidden',
    'innerHeight',
    'isMobile',
    'getUserMedia',
    'heartbeatInterval',
    'disconnectWS',
    '2034891skVaZg',
    '14337776udbdwK',
    'videoWidth',
    'detachCamera',
    '6240860dmhDHQ',
    'auto',
    'livenessCb',
    'appendChild',
    'autoplay',
    'startLiveness',
    'image/x-jpeg-base64',
    'ctx',
    'OPEN',
    '12uLEPut',
    'video',
    'image/jpeg',
    'token',
    'unknown',
    'stop',
    'isWSConnected',
    'createElement',
    '[Face\x20Recognition]:\x20закрыт.',
  ];
  _0x44bf = function () {
    return _0x5a4bae;
  };
  return _0x44bf();
}
function _0x5f5a(_0x188f54, _0x5ae4bc) {
  const _0x44bf35 = _0x44bf();
  return (
    (_0x5f5a = function (_0x5f5a14, _0x34a570) {
      _0x5f5a14 = _0x5f5a14 - 0x157;
      let _0xcb4ea7 = _0x44bf35[_0x5f5a14];
      return _0xcb4ea7;
    }),
    _0x5f5a(_0x188f54, _0x5ae4bc)
  );
}
function mirrorBase64(
  _0xed1f92,
  _0x30544c = _0x3d8740(0x180),
  _0xb81992 = 0.6
) {
  return new Promise((_0x39af01, _0xade82c) => {
    const _0x53f969 = _0x5f5a,
      _0x3b498f = new Image();
    ((_0x3b498f['crossOrigin'] = 'anonymous'),
      (_0x3b498f[_0x53f969(0x1a1)] = () => {
        const _0x3662cf = _0x53f969,
          _0x20fea4 = document[_0x3662cf(0x185)](_0x3662cf(0x19e)),
          _0xa71e06 = _0x20fea4[_0x3662cf(0x1a6)]('2d');
        ((_0x20fea4[_0x3662cf(0x1a2)] = _0x3b498f[_0x3662cf(0x1a2)]),
          (_0x20fea4['height'] = _0x3b498f['height']),
          _0xa71e06['translate'](_0x20fea4['width'], 0x0),
          _0xa71e06[_0x3662cf(0x18b)](-0x1, 0x1),
          _0xa71e06[_0x3662cf(0x1a8)](_0x3b498f, 0x0, 0x0));
        const _0x434bd8 = _0x20fea4[_0x3662cf(0x1a0)](_0x30544c, _0xb81992);
        _0x39af01(_0x434bd8);
      }),
      (_0x3b498f[_0x53f969(0x18f)] = _0xade82c),
      (_0x3b498f[_0x53f969(0x19f)] = _0xed1f92));
  });
}
class FaceRecognition {
  constructor(_0x3a9370, _0x2e0c8b) {
    const _0x1570a5 = _0x3d8740;
    ((this[_0x1570a5(0x1a2)] = window[_0x1570a5(0x15e)]),
      (this[_0x1570a5(0x18d)] = window[_0x1570a5(0x16c)]),
      (this[_0x1570a5(0x16d)] = this[_0x1570a5(0x1a2)] < 0x1e0),
      (this[_0x1570a5(0x184)] = ![]),
      (this['canvas'] = null),
      (this[_0x1570a5(0x17c)] = null),
      (this[_0x1570a5(0x17f)] = null),
      (this[_0x1570a5(0x188)] = null),
      (this['ws'] = null),
      (this[_0x1570a5(0x197)] = null),
      (this['rootNode'] = _0x3a9370),
      (this['options'] = _0x2e0c8b),
      (this[_0x1570a5(0x1a5)] = navigator),
      (this[_0x1570a5(0x165)] = ![]),
      (this['isUnavailableCamera'] = ![]),
      (this[_0x1570a5(0x17a)] = ![]),
      (this[_0x1570a5(0x188)] = _0x1570a5(0x182)),
      (this[_0x1570a5(0x177)] = null),
      (this[_0x1570a5(0x198)] = null),
      (this[_0x1570a5(0x194)] = null),
      (this['isSuccess'] = ![]),
      this[_0x1570a5(0x169)]());
  }
  [_0x3d8740(0x169)]() {
    const _0x2b5eb8 = _0x3d8740;
    ((this[_0x2b5eb8(0x19e)] = document[_0x2b5eb8(0x185)]('canvas')),
      (this[_0x2b5eb8(0x19e)][_0x2b5eb8(0x168)][_0x2b5eb8(0x1a9)] =
        _0x2b5eb8(0x15c)),
      (this[_0x2b5eb8(0x17f)] = document['createElement'](_0x2b5eb8(0x17f))),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x179)] = !![]),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x19c)] = !![]),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x19a)] = !![]),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x168)][_0x2b5eb8(0x1a2)] = this[
        _0x2b5eb8(0x16d)
      ]
        ? _0x2b5eb8(0x176)
        : 0x217 + 'px'),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x168)][_0x2b5eb8(0x18d)] = this[
        _0x2b5eb8(0x16d)
      ]
        ? _0x2b5eb8(0x176)
        : 0x280 + 'px'),
      (this[_0x2b5eb8(0x17f)][_0x2b5eb8(0x168)][_0x2b5eb8(0x157)] =
        this[_0x2b5eb8(0x16d)] && this['options']?.[_0x2b5eb8(0x192)] !== 'user'
          ? ''
          : _0x2b5eb8(0x189)),
      (this[_0x2b5eb8(0x1ae)][_0x2b5eb8(0x168)][_0x2b5eb8(0x1a9)] =
        _0x2b5eb8(0x1a4)),
      (this['rootNode']['style']['alignItems'] = _0x2b5eb8(0x191)),
      (this[_0x2b5eb8(0x1ae)][_0x2b5eb8(0x168)][_0x2b5eb8(0x18d)] =
        _0x2b5eb8(0x1a3)),
      (this[_0x2b5eb8(0x1ae)][_0x2b5eb8(0x168)][_0x2b5eb8(0x19d)] =
        _0x2b5eb8(0x16b)),
      (this[_0x2b5eb8(0x1ae)]['style']['justifyContent'] = _0x2b5eb8(0x191)),
      this[_0x2b5eb8(0x1ae)][_0x2b5eb8(0x178)](this[_0x2b5eb8(0x17f)]),
      (this['ctx'] = this['canvas']['getContext']('2d')));
  }
  async [_0x3d8740(0x18a)]() {
    return new Promise((_0x3d0524, _0x24820c) => {
      const _0x4fdae6 = _0x5f5a;
      try {
        this[_0x4fdae6(0x1a5)][_0x4fdae6(0x160)]
          [
            _0x4fdae6(0x16e)
          ]({ video: { width: { ideal: this[_0x4fdae6(0x16d)] ? this[_0x4fdae6(0x18d)] : 0x1e0 }, height: { ideal: this[_0x4fdae6(0x16d)] ? this[_0x4fdae6(0x1a2)] : 0x280 }, facingMode: { ideal: this[_0x4fdae6(0x15b)]?.['mode'] ?? 'user' } } })
          [_0x4fdae6(0x18c)]((_0xe2f421) => {
            const _0x1486a1 = _0x4fdae6;
            ((this[_0x1486a1(0x165)] = !![]),
              (this[_0x1486a1(0x17f)][_0x1486a1(0x15f)] = _0xe2f421));
            const _0x3ce6e5 = _0xe2f421[_0x1486a1(0x159)]()[0x0],
              _0x2ea54f = _0x3ce6e5[_0x1486a1(0x15a)]();
            ((this[_0x1486a1(0x188)] = _0x2ea54f[_0x1486a1(0x188)]),
              _0x3d0524(_0x1486a1(0x193), _0xe2f421));
          });
      } catch (_0xa1fd82) {
        ((this[_0x4fdae6(0x199)] = !![]),
          console[_0x4fdae6(0x195)](_0xa1fd82),
          _0x24820c('ошибка:\x20', _0xa1fd82));
      }
    });
  }
  async ['detachCamera']() {
    const _0xcf825c = _0x3d8740,
      _0x29d616 = this[_0xcf825c(0x17f)][_0xcf825c(0x15f)];
    _0x29d616 &&
      (_0x29d616['getTracks']()[_0xcf825c(0x158)]((_0x14fd97) =>
        _0x14fd97[_0xcf825c(0x183)]()
      ),
      (this[_0xcf825c(0x17f)]['srcObject'] = null));
  }
  async [_0x3d8740(0x166)]() {
    const _0x140c25 = _0x3d8740;
    return (
      (this[_0x140c25(0x184)] = !![]),
      (this['timeout'] = setTimeout(() => {
        const _0x3d999a = _0x140c25;
        this[_0x3d999a(0x170)]();
      }, this[_0x140c25(0x15b)][_0x140c25(0x194)])),
      new Promise((_0x5b73f7, _0x316752) => {
        const _0x13cefc = _0x140c25;
        try {
          ((this['ws'] = new WebSocket(this[_0x13cefc(0x15b)]['url'])),
            this['ws'][_0x13cefc(0x16a)]('open', () => {
              const _0x38ca2f = _0x13cefc;
              console[_0x38ca2f(0x195)](
                '[Face\x20Recognition]:\x20открыт.\x20Отправляем\x20CONNECT...'
              );
              const _0xb00981 = {
                command: 'CONNECT',
                version: _0x38ca2f(0x162),
                device: this[_0x38ca2f(0x188)],
                token: this[_0x38ca2f(0x15b)][_0x38ca2f(0x181)],
              };
              (this['ws'][_0x38ca2f(0x187)](JSON[_0x38ca2f(0x164)](_0xb00981)),
                _0x5b73f7());
            }),
            this['ws'][_0x13cefc(0x16a)](_0x13cefc(0x163), (_0x54965c) => {
              const _0xadf17 = _0x13cefc;
              if (this['livenessCb']) {
                const _0x9815f6 = JSON[_0xadf17(0x1af)](
                  _0x54965c?.[_0xadf17(0x15d)]
                );
                (_0x9815f6?.['command'] === 'SUCCESS' &&
                  (this[_0xadf17(0x1ac)] = !![]),
                  this[_0xadf17(0x177)](_0x54965c['data']));
              }
            }),
            this['ws'][_0x13cefc(0x16a)]('error', (_0x88fd74) => {
              const _0x43ae2d = _0x13cefc;
              (this[_0x43ae2d(0x170)](),
                _0x316752(_0x88fd74),
                this[_0x43ae2d(0x198)] &&
                  !this['isSuccess'] &&
                  this[_0x43ae2d(0x198)](_0x88fd74));
            }),
            this['ws']['addEventListener'](_0x13cefc(0x196), () => {
              const _0x3ac1dc = _0x13cefc;
              (!this['isSuccess'] &&
                this['onError'] &&
                this[_0x3ac1dc(0x198)](
                  new Error('Не\x20удалось\x20распознать\x20лицо')
                ),
                this['disconnectWS'](),
                console[_0x3ac1dc(0x195)](_0x3ac1dc(0x186)));
            }));
        } catch (_0x1a72b2) {
          (this['disconnectWS'](), _0x316752(_0x1a72b2));
        }
      })
    );
  }
  async [_0x3d8740(0x170)]() {
    const _0x8af4cd = _0x3d8740;
    try {
      (this['ws']?.[_0x8af4cd(0x196)](
        0x3e8,
        '[Face\x20Recognition]:\x20закрыт.'
      ),
        (this[_0x8af4cd(0x17a)] = ![]),
        clearInterval(this[_0x8af4cd(0x197)]),
        clearTimeout(this[_0x8af4cd(0x194)]),
        (this[_0x8af4cd(0x194)] = null),
        (this[_0x8af4cd(0x197)] = null),
        (this['isWSConnected'] = ![]),
        await this[_0x8af4cd(0x174)]());
    } catch (_0x184a2e) {
      console[_0x8af4cd(0x195)](_0x184a2e);
    }
  }
  async ['checkLiveness'](_0x4ea32e, _0x435fd7) {
    const _0x123c46 = _0x3d8740;
    return (
      (this['livenessCb'] = _0x4ea32e),
      (this['onError'] = _0x435fd7),
      (this[_0x123c46(0x17a)] = !![]),
      this[_0x123c46(0x17a)] &&
        !this[_0x123c46(0x197)] &&
        this['ws']?.[_0x123c46(0x1a7)] === WebSocket[_0x123c46(0x17d)] &&
        (this[_0x123c46(0x197)] = setInterval(async () => {
          const _0x5151ae = _0x123c46;
          this[_0x5151ae(0x17f)][_0x5151ae(0x173)] === 0x0 &&
            this[_0x5151ae(0x170)]();
          ((this[_0x5151ae(0x19e)][_0x5151ae(0x1a2)] =
            this[_0x5151ae(0x17f)][_0x5151ae(0x173)]),
            (this['canvas']['height'] =
              this[_0x5151ae(0x17f)][_0x5151ae(0x19b)]),
            this[_0x5151ae(0x17c)][_0x5151ae(0x1a8)](
              this[_0x5151ae(0x17f)],
              0x0,
              0x0,
              this[_0x5151ae(0x19e)][_0x5151ae(0x1a2)],
              this[_0x5151ae(0x19e)]['height']
            ));
          const _0x51ce03 = this[_0x5151ae(0x16d)] ? 0.7 : 0x1,
            _0x5346ce = this['canvas']['toDataURL']('image/jpeg', _0x51ce03),
            _0xc6ca78 = await mirrorBase64(_0x5346ce, 'image/jpeg', _0x51ce03),
            _0x16d729 = {
              command: 'FRAME',
              'content-type': _0x5151ae(0x17b),
              device: this[_0x5151ae(0x188)],
              data: _0xc6ca78[_0x5151ae(0x1aa)](',')[0x1],
              token: this[_0x5151ae(0x15b)][_0x5151ae(0x181)],
            };
          this['ws']['send'](JSON[_0x5151ae(0x164)](_0x16d729));
        }, this[_0x123c46(0x15b)][_0x123c46(0x16f)])),
      this['isSuccess']
    );
  }
}
